<div class="registro-container gestor-variant">
  <!-- Bot√≥n de volver -->
  <button type="button" class="back-to-home" [routerLink]="ADMINISTRADOR_ROUTES.inicio">
    <span class="btn-icon">‚Üê</span>
    <span class="btn-text">Volver al Dashboard</span>
  </button>

  <main class="perfil-card gestor-variant">
    <!-- SECCI√ìN 1: HEADER CON T√çTULO -->
    <header class="app-header ">
      <div class="header-content">
        <h2>Mi Perfil de Administrador</h2>
        <p class="header-subtitle">Gestiona tu informaci√≥n personal y configuraci√≥n</p>
      </div>
    </header>

    <!-- SECCI√ìN 2: INFORMACI√ìN DEL PERFIL -->
    <section class="profile-info-section">
      <div class="profile-layout">
        <!-- Columna izquierda: Avatar y datos b√°sicos -->
        <div class="profile-sidebar">
          <div class="photo-upload">
            <div class="avatar-container">
              <img [src]="administradorProfile.fotoPerfil" [alt]="'Avatar de ' + administradorProfile.nombre" class="avatar">
            </div>
            <div class="upload-actions" *ngIf="isEditMode">
              <label for="foto-perfil" class="upload-btn">
                üì∑ Cambiar Foto
                <input type="file" id="foto-perfil" accept="image/*" (change)="onFileSelected($event)" hidden>
              </label>
            </div>
          </div>
          
          <div class="user-identity">
            <h3 class="user-name">{{ administradorProfile.nombre }} {{ administradorProfile.primerApellido }} {{ administradorProfile.segundoApellido }}</h3>
            <p class="user-email">{{ '@' + administradorProfile.alias }}</p>
          </div>
        </div>

        <!-- Columna derecha: Informaci√≥n detallada -->
        <div class="profile-content">
          <form [formGroup]="administradorForm" *ngIf="isEditMode; else displayMode">
            <div class="info-display edit-mode">
              <div class="info-item">
                <label class="field-label" for="nombre">Nombre</label>
                <input 
                  type="text" 
                  id="nombre"
                  class="info-input" 
                  formControlName="nombre"
                  [class.input-error]="isFieldInvalid('nombre')"
                  placeholder="Ingresa tu nombre">
                <div class="error-message" *ngIf="isFieldInvalid('nombre')">
                  {{ getFieldError('nombre') }}
                </div>
              </div>

              <div class="info-item">
                <label class="field-label" for="primerApellido">Primer Apellido</label>
                <input 
                  type="text" 
                  id="primerApellido"
                  class="info-input" 
                  formControlName="primerApellido"
                  [class.input-error]="isFieldInvalid('primerApellido')"
                  placeholder="Ingresa tu primer apellido">
                <div class="error-message" *ngIf="isFieldInvalid('primerApellido')">
                  {{ getFieldError('primerApellido') }}
                </div>
              </div>

              <div class="info-item">
                <label class="field-label" for="segundoApellido">Segundo Apellido (opcional)</label>
                <input 
                  type="text" 
                  id="segundoApellido"
                  class="info-input" 
                  formControlName="segundoApellido"
                  [class.input-error]="isFieldInvalid('segundoApellido')"
                  placeholder="Ingresa tu segundo apellido">
                <div class="error-message" *ngIf="isFieldInvalid('segundoApellido')">
                  {{ getFieldError('segundoApellido') }}
                </div>
              </div>

              <div class="info-item">
                <label class="field-label" for="alias">Alias</label>
                <input 
                  type="text" 
                  id="alias"
                  class="info-input" 
                  formControlName="alias"
                  [class.input-error]="isFieldInvalid('alias')"
                  placeholder="Ingresa tu alias"
                  maxlength="12">
                <div class="error-message" *ngIf="isFieldInvalid('alias')">
                  {{ getFieldError('alias') }}
                </div>
              </div>

            
              <div class="info-item">
                <span class="field-label">Email</span>
                <span class="info-value readonly">{{ administradorProfile.email }} </span>
                <div class="info-message" style="font-size: 0.875rem; color: #6b7280; margin-top: 0.25rem;">
                  El email no puede ser modificado
                </div>
              </div>

              <div class="info-item">
                <label class="field-label" for="departamento">Departamento</label>
                <input
                  type="text" 
                  id="departamento"
                  class="info-input"
                  [value]="administradorProfile.departamento"
                  disabled
                  readonly
                  style="cursor: not-allowed;">
                <div class="info-message" style="font-size: 0.875rem; color: #6b7280; margin-top: 0.25rem;">
                  El departamento no puede ser modificado
                </div>
              </div>
            
            </div>
          </form>

          <ng-template #displayMode>
            <div class="info-display">
              <div class="info-item">
                <span class="field-label">Nombre Completo</span>
                <span class="info-value">{{ administradorProfile.nombre }} {{ administradorProfile.primerApellido }} {{ administradorProfile.segundoApellido }}</span>
              </div>

              <div class="info-item">
                <span class="field-label">Email</span>
                <span class="info-value">{{ administradorProfile.email }}</span>
              </div>

              <div class="info-item">
                <span class="field-label">Alias</span>
                <span class="info-value">{{ '@' + administradorProfile.alias }}</span>
              </div>

              <div class="info-item" >
                <span class="field-label">Departamento</span>
                <span class="info-value">{{ administradorProfile.departamento }}</span>
              </div>
            </div>
          </ng-template>
        </div>
      </div>
    </section>

    <!-- SECCI√ìN 3: BOTONERA (3 BOTONES UNO AL LADO DEL OTRO) -->
    <section class="profile-actions-section">
      <div class="actions-container" *ngIf="!isEditMode">
        <button type="button" class="gestor-btn" (click)="toggleEditMode()">
          <span class="btn-icon">‚úèÔ∏è</span>
          <span class="btn-text">Modificar Perfil</span>
        </button>
      </div>

      <div class="actions-container edit-mode" *ngIf="isEditMode">
        <button 
          type="button" 
          class="gestor-btn" 
          [disabled]="administradorForm.invalid"
          (click)="saveProfile()">
          <span class="btn-icon">üíæ</span>
          <span class="btn-text">Guardar Cambios</span>
        </button>
        <button type="button" class="gestor-btn" (click)="changePassword()">
          <span class="btn-icon">üîí</span>
          <span class="btn-text">Cambiar Contrase√±a</span>
        </button>
        <button type="button" class="gestor-btn secondary" (click)="cancelEdit()">
          <span class="btn-icon">‚ùå</span>
          <span class="btn-text">Cancelar</span>
        </button>
      </div>
    </section>
  </main>



  <!-- Modal de cambiar contrase√±a usando componente compartido -->
  <app-cambiar-password-modal
    [visible]="showChangePasswordModal"
    [passwordForm]="passwordForm"
    [variant]="'gestor-variant'"
    (confirm)="confirmChangePassword()"
    (cancelChange)="cancelChangePassword()">
  </app-cambiar-password-modal>
</div>