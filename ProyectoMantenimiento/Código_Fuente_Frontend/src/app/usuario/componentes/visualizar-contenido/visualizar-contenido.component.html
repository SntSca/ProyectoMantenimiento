<div class="dashboard-container usuario-variant">
  <!-- Menu Lateral Izquierdo -->
  <aside class="sidebar-menu">
    <button type="button" class="user-profile" [routerLink]="USUARIO_ROUTES.perfil">
      <div class="avatar-container">
        <img src="{{ userProfile.fotoPerfil || 'assets/porDefecto.jpg' }}" alt="Avatar del usuario" class="user-avatar">
      </div>
      <div class="user-info">
        <h3 class="user-name">{{ userProfile.nombre }} {{ userProfile.primerApellido }}</h3>
        <p class="profile-hint">üë§ Ver perfil</p>
      </div>
    </button>
    
    <nav class="menu-navigation">
      <ul class="menu-list">
        <li class="menu-item" [class.active]="isMenuSectionActive('inicio')">
          <button type="button" class="menu-button" (click)="setActiveMenuSection('inicio')">
            <div class="menu-text">
              <span class="menu-icon">üè†</span>
              <span>Inicio</span>
            </div>
          </button>
        </li>
        <li class="menu-item" [class.active]="isMenuSectionActive('listas-publicas')">
          <button type="button" class="menu-button" (click)="setActiveMenuSection('listas-publicas')">
            <div class="menu-text">
              <span class="menu-icon">üåê</span>
              <span>Listas P√∫blicas</span>
            </div>
          </button>
        </li>
        <li class="menu-item">
          <button type="button" class="menu-button" [routerLink]="USUARIO_ROUTES.listas" [queryParams]="{ tipo: 'privadas' }">
            <div class="menu-text">
              <span class="menu-icon">üìã</span>
              <span>Mis Listas</span>
            </div>
          </button>
        </li>
        <li class="menu-item">
          <button type="button" class="menu-button" [routerLink]="USUARIO_ROUTES.crearListaPrivada">
            <div class="menu-text">
              <span class="menu-icon">‚ûï</span>
              <span>Crear Lista Privada</span>
            </div>
          </button>
        </li>
        <li class="menu-item" [class.active]="isMenuSectionActive('favoritos')">
          <button type="button" class="menu-button" (click)="loadFavorites()">
            <div class="menu-text">
              <span class="menu-icon">‚≠ê</span>
              <span>Favoritos</span>
            </div>
          </button>
        </li>
      </ul>
      
      <div class="menu-divider"></div>
      
      <ul class="menu-list">
        <li class="menu-item logout">
          <button (click)="logout()" class="logout-button">
            <div class="menu-text">
              <span class="menu-icon">üö™</span>
              <span>Cerrar Sesi√≥n</span>
            </div>
          </button>
        </li>
      </ul>
    </nav>
  </aside>

  <main class="main-content" *ngIf="contenido">
    <header class="app-header">
      <h2>{{ contenido.titulo || 'Visualizador de contenido' }} {{ contenido.tipo === 'AUDIO' ? 'üéß' : 'üé•' }}</h2>
    </header>

    <section class="viewer-section">
      <div class="media-wrapper">
        <!-- Video player -->
        <iframe #mediaPlayer *ngIf="contenido?.tipo === 'VIDEO'" [src]="getEmbedUrl()" [title]="contenido.titulo" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

        <!-- Audio player con miniatura de fondo -->
        <div class="audio-player" *ngIf="contenido?.tipo === 'AUDIO'">
          <div class="audio-background" [style.background-image]="thumbnailStyle">
            <div class="audio-overlay">
              <audio #mediaPlayer [src]="mediaSrc" controls controlsList="nodownload"></audio>
            </div>
          </div>
        </div>
      </div>

      <div class="metadata">
        <div class="metadata-left">
          <!-- Rating Section -->
          <div class="rating-section">
            <div class="rating-row">
              <div class="rating-display">
                <span class="section-title">Valoraci√≥n media:</span>
                <div class="section-content stars-display">
                  <span *ngFor="let star of getStarsArray(contenido.valoracionMedia || 0)" class="star">
                    {{ star === 1 ? '‚òÖ' : star === 0.5 ? '‚Ø™' : '‚òÜ' }}
                  </span>
                  <span class="rating-value">({{ (contenido.valoracionMedia || 0).toFixed(1) }})</span>
                </div>
              </div>
              <div class="rating-vote">
                <span class="section-title">Tu valoraci√≥n:</span>
                <div class="section-content stars-interactive">
                  <button
                    *ngFor="let star of [0.5,1,1.5,2,2.5,3,3.5,4,4.5,5]"
                    type="button"
                    class="star interactive"
                    [class.selected]="star <= (hoverRating || contenido.valoracionUsuario)"
                    [disabled]="contenido.valoracionUsuario > 0"
                    (click)="contenido.valoracionUsuario > 0 ? null : rateContent(star)"
                    (mouseenter)="contenido.valoracionUsuario > 0 ? null : hoverRating = star"
                    (mouseleave)="contenido.valoracionUsuario > 0 ? null : hoverRating = 0"
                  >
                    {{ star % 1 === 0 ? '‚òÖ' : '‚Ø™' }}
                  </button>
                </div>
              </div>
              <div class="favorite-toggle">
                <button 
                  type="button"
                  class="favorite-button" 
                  [class.is-favorite]="isFavorite"
                  (click)="toggleFavorite()"
                  [attr.aria-label]="isFavorite ? 'Quitar de favoritos' : 'A√±adir a favoritos'">
                  <span class="heart-icon">{{ isFavorite ? '‚ù§Ô∏è' : 'ü§ç' }}</span>
                  <span class="favorite-text">{{ isFavorite ? 'En favoritos' : 'A√±adir a favoritos' }}</span>
                </button>
              </div>
            </div>
          </div>

          <div class="meta-description">
            <span class="section-title">Descripci√≥n:</span>
            <p class="section-content">{{ contenido.descripcion }}</p>
          </div>
        </div>
        <div class="metadata-right">
          <div class="meta-item">
            <span class="section-title">Tags:</span>
            <span class="section-content">{{ contenido.tags.join(', ') }}</span>
          </div>
          <div class="meta-item">
            <span class="section-title">Especialidad:</span>
            <span class="section-content">{{ contenido.especialidad }}</span>
            <span class="section-title">VIP:</span>
            <span class="section-content">{{ contenido.esVIP ? 'Si' : 'No' }}</span>
            <span class="section-title">Restricci√≥n de Edad:</span>
            <span class="section-content">{{ contenido.restriccionEdad }}</span>
            <span class="section-title">Fecha de Expiraci√≥n:</span>
            <span class="section-content">{{ contenido.fechaExpiracion ? (contenido.fechaExpiracion | date:'dd/MM/yyyy') : 'Sin expiraci√≥n' }}</span>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>
